#!/bin/bash
echo "Configuring environment"
export CORE_LOGGING_LEVEL="DEBUG"
export CORE_NEXT="true"
export CORE_VM_ENDPOINT="unix:///var/run/docker.sock"
export CORE_PEER_ID="peer0"
export CORE_PEER_ENDORSER_ENABLED="true"
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_MSPCONFIGPATH="/etc/hyperledger/msp/peer/"
export CORE_PEER_GOSSIP_ORGLEADER="true"

#removed this line because I added the line below.
#export CORE_PEER_ADDRESS="peer0:7051"
#Added this line:
export CORE_PEER_ADDRESSAUTODETECT="true"

export CORE_PEER_GOSSIP_EXTERNALENDPOINT="peer0:7051"
export CORE_PEER_TLS_ENABLED="true"
export CORE_PEER_TLS_KEY_FILE="/etc/hyperledger/tls/key.pem"
export CORE_PEER_TLS_CERT_FILE="/etc/hyperledger/tls/cert.pem"
export CORE_PEER_TLS_ROOTCERT_FILE="/etc/hyperledger/tls/ca-cert.pem"

#Added and changed this line (from the fabric/test compose file)
#export CORE_PEER_COMMITTER_LEDGER_ORDERER="orderer:7050"
export CORE_PEER_COMMITTER_LEDGER_ORDERER="localhost:7050"

#removed this line
#export CORE_VM_DOCKER_HOSTCONFIG_NETWORKMODE="fixtures_default"

echo "Configuration complete"

